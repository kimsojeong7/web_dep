---
- name: web_dep 자동 배포 플레이북
  hosts: webservers
  become: yes
  vars:
    # 본인의 GitHub 저장소 주소로 변경
    git_repo_url: "https://github.com/kimsojeong7/web_dep.git"
    web_root: "/var/www/html/web_dep"

  tasks:
    - name: Nginx 웹 서버 설치
      apt:
        name: nginx
        state: present
        update_cache: yes
      become: yes

    - name: GitHub 저장소에서 최신 소스 코드 배포
      git:
        repo: "{{ git_repo_url }}"
        dest: "{{ web_root }}"
        version: main
        force: yes

    - name: Nginx 서비스 활성화 및 시작
      service:
        name: nginx
        state: started
        enabled: true

